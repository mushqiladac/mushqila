# Generated by Django 5.2.8 on 2026-01-25 19:23

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('accounts', '0002_alter_commissiontransaction_agent_and_more'),
        ('flights', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Account',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=20, unique=True, verbose_name='Account Code')),
                ('name', models.CharField(max_length=255, verbose_name='Account Name')),
                ('account_type', models.CharField(choices=[('asset', 'Asset'), ('liability', 'Liability'), ('equity', 'Equity'), ('revenue', 'Revenue'), ('expense', 'Expense')], max_length=20, verbose_name='Account Type')),
                ('category', models.CharField(choices=[('cash', 'Cash and Cash Equivalents'), ('receivable', 'Accounts Receivable'), ('inventory', 'Inventory'), ('payable', 'Accounts Payable'), ('deposits', 'Customer Deposits'), ('retained', 'Retained Earnings'), ('ticket_revenue', 'Ticket Revenue'), ('ancillary_revenue', 'Ancillary Revenue'), ('commission_revenue', 'Commission Revenue'), ('airline_costs', 'Airline Ticket Costs'), ('payment_fees', 'Payment Processing Fees'), ('refund_expenses', 'Refund Processing Expenses'), ('commissions_paid', 'Commissions Paid')], max_length=30, verbose_name='Category')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
                ('normal_balance', models.CharField(choices=[('debit', 'Debit'), ('credit', 'Credit')], max_length=10, verbose_name='Normal Balance')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Account',
                'verbose_name_plural': 'Accounts',
                'ordering': ['code'],
            },
        ),
        migrations.CreateModel(
            name='AccountingPeriod',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100, verbose_name='Period Name')),
                ('start_date', models.DateField(verbose_name='Start Date')),
                ('end_date', models.DateField(verbose_name='End Date')),
                ('status', models.CharField(choices=[('open', 'Open'), ('closed', 'Closed'), ('locked', 'Locked')], default='open', max_length=10, verbose_name='Status')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Accounting Period',
                'verbose_name_plural': 'Accounting Periods',
                'ordering': ['-start_date'],
            },
        ),
        migrations.CreateModel(
            name='AccountingRule',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=255, verbose_name='Rule Name')),
                ('rule_type', models.CharField(choices=[('ticket_issue', 'Ticket Issue'), ('ticket_void', 'Ticket Void'), ('ticket_cancel', 'Ticket Cancel'), ('ticket_refund', 'Ticket Refund'), ('payment_received', 'Payment Received'), ('commission_earned', 'Commission Earned'), ('ancillary_sale', 'Ancillary Sale')], max_length=30, unique=True, verbose_name='Rule Type')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('debit_entries', models.JSONField(default=list, verbose_name='Debit Entries')),
                ('credit_entries', models.JSONField(default=list, verbose_name='Credit Entries')),
                ('is_active', models.BooleanField(default=True, verbose_name='Is Active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Accounting Rule',
                'verbose_name_plural': 'Accounting Rules',
                'ordering': ['rule_type'],
            },
        ),
        migrations.CreateModel(
            name='PermissionGroup',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, verbose_name='name')),
                ('code', models.CharField(max_length=50, unique=True, verbose_name='code')),
                ('description', models.TextField(blank=True, verbose_name='description')),
                ('can_book_flights', models.BooleanField(default=False, verbose_name='can book flights')),
                ('can_manage_users', models.BooleanField(default=False, verbose_name='can manage users')),
                ('can_view_reports', models.BooleanField(default=False, verbose_name='can view reports')),
                ('can_manage_finances', models.BooleanField(default=False, verbose_name='can manage finances')),
                ('can_access_api', models.BooleanField(default=False, verbose_name='can access API')),
                ('can_manage_inventory', models.BooleanField(default=False, verbose_name='can manage inventory')),
                ('booking_limit_daily', models.IntegerField(default=0, help_text='0 = unlimited', verbose_name='daily booking limit')),
                ('booking_limit_monthly', models.IntegerField(default=0, help_text='0 = unlimited', verbose_name='monthly booking limit')),
                ('credit_limit_override', models.BooleanField(default=False, verbose_name='can override credit limits')),
                ('commission_override', models.BooleanField(default=False, verbose_name='can override commissions')),
                ('is_active', models.BooleanField(default=True, verbose_name='is active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Permission Group',
                'verbose_name_plural': 'Permission Groups',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='BusinessUnit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, verbose_name='name')),
                ('code', models.CharField(max_length=20, unique=True, verbose_name='code')),
                ('unit_type', models.CharField(choices=[('headquarter', 'Headquarter'), ('branch', 'Branch Office'), ('department', 'Department'), ('division', 'Division')], max_length=20, verbose_name='type')),
                ('address', models.TextField(blank=True, verbose_name='address')),
                ('phone', models.CharField(blank=True, max_length=20, verbose_name='phone')),
                ('email', models.EmailField(blank=True, max_length=254, verbose_name='email')),
                ('is_active', models.BooleanField(default=True, verbose_name='is active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('manager', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='managed_units', to=settings.AUTH_USER_MODEL)),
                ('parent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='sub_units', to='accounts.businessunit')),
            ],
            options={
                'verbose_name': 'Business Unit',
                'verbose_name_plural': 'Business Units',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='FinancialReport',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('report_type', models.CharField(choices=[('profit_loss', 'Profit & Loss Statement'), ('balance_sheet', 'Balance Sheet'), ('cash_flow', 'Cash Flow Statement'), ('trial_balance', 'Trial Balance')], max_length=20, verbose_name='Report Type')),
                ('name', models.CharField(max_length=255, verbose_name='Report Name')),
                ('data', models.JSONField(verbose_name='Report Data')),
                ('generated_at', models.DateTimeField(auto_now_add=True)),
                ('generated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('period', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reports', to='accounts.accountingperiod')),
            ],
            options={
                'verbose_name': 'Financial Report',
                'verbose_name_plural': 'Financial Reports',
                'ordering': ['-generated_at'],
            },
        ),
        migrations.CreateModel(
            name='DashboardWidget',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, verbose_name='name')),
                ('widget_type', models.CharField(choices=[('metric', 'Metric Card'), ('chart', 'Chart'), ('table', 'Data Table'), ('alert', 'Alert/Notification'), ('quick_action', 'Quick Action')], max_length=20, verbose_name='type')),
                ('title', models.CharField(max_length=255, verbose_name='title')),
                ('description', models.TextField(blank=True, verbose_name='description')),
                ('config', models.JSONField(default=dict, verbose_name='configuration')),
                ('data_source', models.CharField(blank=True, max_length=255, verbose_name='data source')),
                ('refresh_interval', models.IntegerField(default=300, verbose_name='refresh interval (seconds)')),
                ('allowed_user_types', models.JSONField(default=list, verbose_name='allowed user types')),
                ('position_x', models.IntegerField(default=0, verbose_name='position X')),
                ('position_y', models.IntegerField(default=0, verbose_name='position Y')),
                ('width', models.IntegerField(default=4, verbose_name='width')),
                ('height', models.IntegerField(default=3, verbose_name='height')),
                ('is_active', models.BooleanField(default=True, verbose_name='is active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_widgets', to=settings.AUTH_USER_MODEL)),
                ('allowed_groups', models.ManyToManyField(blank=True, related_name='widgets', to='accounts.permissiongroup')),
            ],
            options={
                'verbose_name': 'Dashboard Widget',
                'verbose_name_plural': 'Dashboard Widgets',
                'ordering': ['position_y', 'position_x'],
            },
        ),
        migrations.CreateModel(
            name='BusinessRule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, verbose_name='name')),
                ('rule_type', models.CharField(choices=[('commission', 'Commission Rule'), ('credit_limit', 'Credit Limit Rule'), ('booking_restriction', 'Booking Restriction'), ('price_modifier', 'Price Modifier'), ('discount', 'Discount Rule')], max_length=30, verbose_name='rule type')),
                ('description', models.TextField(blank=True, verbose_name='description')),
                ('condition_type', models.CharField(choices=[('user_type', 'User Type'), ('user_group', 'User Group'), ('booking_amount', 'Booking Amount'), ('destination', 'Destination'), ('service_type', 'Service Type'), ('time_range', 'Time Range'), ('custom', 'Custom Condition')], max_length=30, verbose_name='condition type')),
                ('condition_value', models.JSONField(default=dict, verbose_name='condition value')),
                ('action_value', models.JSONField(default=dict, verbose_name='action value')),
                ('priority', models.IntegerField(default=0, help_text='Higher priority rules are applied first', verbose_name='priority')),
                ('is_active', models.BooleanField(default=True, verbose_name='is active')),
                ('start_date', models.DateTimeField(blank=True, null=True, verbose_name='start date')),
                ('end_date', models.DateTimeField(blank=True, null=True, verbose_name='end date')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('applicable_users', models.ManyToManyField(blank=True, related_name='business_rules', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_rules', to=settings.AUTH_USER_MODEL)),
                ('applicable_groups', models.ManyToManyField(blank=True, related_name='business_rules', to='accounts.permissiongroup')),
            ],
            options={
                'verbose_name': 'Business Rule',
                'verbose_name_plural': 'Business Rules',
                'ordering': ['-priority', 'name'],
            },
        ),
        migrations.CreateModel(
            name='SystemConfiguration',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('key', models.CharField(max_length=255, unique=True, verbose_name='key')),
                ('config_type', models.CharField(choices=[('general', 'General'), ('financial', 'Financial'), ('security', 'Security'), ('api', 'API'), ('notification', 'Notification')], default='general', max_length=20, verbose_name='type')),
                ('value', models.JSONField(default=dict, verbose_name='value')),
                ('description', models.TextField(blank=True, verbose_name='description')),
                ('is_system', models.BooleanField(default=False, verbose_name='is system setting')),
                ('is_editable', models.BooleanField(default=True, verbose_name='is editable')),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('updated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='config_updates', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'System Configuration',
                'verbose_name_plural': 'System Configurations',
                'ordering': ['config_type', 'key'],
            },
        ),
        migrations.CreateModel(
            name='APIKey',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, verbose_name='name')),
                ('key_type', models.CharField(choices=[('production', 'Production'), ('sandbox', 'Sandbox'), ('development', 'Development')], default='development', max_length=20, verbose_name='type')),
                ('status', models.CharField(choices=[('active', 'Active'), ('inactive', 'Inactive'), ('suspended', 'Suspended'), ('expired', 'Expired')], default='active', max_length=20, verbose_name='status')),
                ('api_key', models.CharField(max_length=64, unique=True, verbose_name='API Key')),
                ('secret_key', models.CharField(max_length=128, verbose_name='Secret Key')),
                ('allowed_ips', models.JSONField(blank=True, default=list, verbose_name='allowed IPs')),
                ('rate_limit_per_minute', models.IntegerField(default=60, verbose_name='rate limit per minute')),
                ('rate_limit_per_hour', models.IntegerField(default=1000, verbose_name='rate limit per hour')),
                ('total_requests', models.BigIntegerField(default=0, verbose_name='total requests')),
                ('requests_today', models.IntegerField(default=0, verbose_name='requests today')),
                ('last_request_at', models.DateTimeField(blank=True, null=True, verbose_name='last request')),
                ('expires_at', models.DateTimeField(blank=True, null=True, verbose_name='expires at')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='api_keys', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'API Key',
                'verbose_name_plural': 'API Keys',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['api_key'], name='accounts_ap_api_key_67a0a0_idx'), models.Index(fields=['user', 'status'], name='accounts_ap_user_id_960c60_idx')],
            },
        ),
        migrations.CreateModel(
            name='AuditLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action_type', models.CharField(choices=[('create', 'Create'), ('update', 'Update'), ('delete', 'Delete'), ('login', 'Login'), ('logout', 'Logout'), ('api_access', 'API Access'), ('financial', 'Financial Action'), ('security', 'Security Event')], max_length=20, verbose_name='action type')),
                ('object_type', models.CharField(max_length=100, verbose_name='object type')),
                ('object_id', models.CharField(blank=True, max_length=100, verbose_name='object ID')),
                ('description', models.TextField(verbose_name='description')),
                ('old_values', models.JSONField(blank=True, default=dict, verbose_name='old values')),
                ('new_values', models.JSONField(blank=True, default=dict, verbose_name='new values')),
                ('metadata', models.JSONField(blank=True, default=dict, verbose_name='metadata')),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True, verbose_name='IP address')),
                ('user_agent', models.TextField(blank=True, verbose_name='user agent')),
                ('session_id', models.CharField(blank=True, max_length=255, verbose_name='session ID')),
                ('is_success', models.BooleanField(default=True, verbose_name='is success')),
                ('error_message', models.TextField(blank=True, verbose_name='error message')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Audit Log',
                'verbose_name_plural': 'Audit Logs',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'created_at'], name='accounts_au_user_id_7b1069_idx'), models.Index(fields=['action_type', 'created_at'], name='accounts_au_action__a03b41_idx'), models.Index(fields=['object_type', 'object_id'], name='accounts_au_object__353b30_idx')],
            },
        ),
        migrations.CreateModel(
            name='JournalEntry',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('date', models.DateField(default=django.utils.timezone.now, verbose_name='Date')),
                ('reference_number', models.CharField(max_length=50, unique=True, verbose_name='Reference Number')),
                ('transaction_type', models.CharField(choices=[('ticket_issue', 'Ticket Issue'), ('ticket_void', 'Ticket Void'), ('ticket_cancel', 'Ticket Cancel'), ('ticket_refund', 'Ticket Refund'), ('payment_received', 'Payment Received'), ('payment_refunded', 'Payment Refunded'), ('commission_earned', 'Commission Earned'), ('commission_paid', 'Commission Paid'), ('ancillary_sale', 'Ancillary Sale'), ('ancillary_refund', 'Ancillary Refund')], max_length=30, verbose_name='Transaction Type')),
                ('description', models.TextField(verbose_name='Description')),
                ('entry_type', models.CharField(choices=[('debit', 'Debit'), ('credit', 'Credit')], max_length=10, verbose_name='Entry Type')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=12, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Amount')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('account', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='entries', to='accounts.account')),
                ('booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='journal_entries', to='flights.booking')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_entries', to=settings.AUTH_USER_MODEL)),
                ('payment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='journal_entries', to='flights.payment')),
                ('ticket', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='journal_entries', to='flights.ticket')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='journal_entries', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Journal Entry',
                'verbose_name_plural': 'Journal Entries',
                'ordering': ['-date', '-created_at'],
                'unique_together': {('reference_number',)},
            },
        ),
    ]
