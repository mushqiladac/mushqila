# Generated by Django 5.2.8 on 2025-12-14 19:18

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='HajjPackage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('package_code', models.CharField(max_length=50, unique=True, verbose_name='package code')),
                ('name', models.CharField(max_length=255, verbose_name='package name')),
                ('name_ar', models.CharField(max_length=255, verbose_name='package name (Arabic)')),
                ('description', models.TextField(blank=True, verbose_name='description')),
                ('description_ar', models.TextField(blank=True, verbose_name='description (Arabic)')),
                ('duration_days', models.IntegerField(default=30, verbose_name='duration (days)')),
                ('hajj_year', models.IntegerField(verbose_name='hajj year')),
                ('makkah_hotel', models.CharField(blank=True, max_length=255, verbose_name='makkah hotel')),
                ('makkah_hotel_distance', models.CharField(blank=True, max_length=50, verbose_name='makkah hotel distance')),
                ('madinah_hotel', models.CharField(blank=True, max_length=255, verbose_name='madinah hotel')),
                ('madinah_hotel_distance', models.CharField(blank=True, max_length=50, verbose_name='madinah hotel distance')),
                ('flight_included', models.BooleanField(default=True, verbose_name='flight included')),
                ('transport_included', models.BooleanField(default=True, verbose_name='transport included')),
                ('base_price', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='base price')),
                ('commission_rate', models.DecimalField(decimal_places=2, default=Decimal('15.00'), max_digits=5, verbose_name='commission rate')),
                ('available_slots', models.IntegerField(default=0, verbose_name='available slots')),
                ('total_slots', models.IntegerField(default=0, verbose_name='total slots')),
                ('status', models.CharField(choices=[('available', 'Available'), ('sold_out', 'Sold Out'), ('coming_soon', 'Coming Soon'), ('inactive', 'Inactive')], default='available', max_length=20, verbose_name='status')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'hajj package',
                'verbose_name_plural': 'hajj packages',
                'ordering': ['-hajj_year', 'base_price'],
            },
        ),
        migrations.CreateModel(
            name='SaudiCity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name_ar', models.CharField(max_length=100, verbose_name='name (Arabic)')),
                ('name_en', models.CharField(max_length=100, verbose_name='name (English)')),
                ('postal_code', models.CharField(blank=True, max_length=10, verbose_name='postal code')),
                ('is_major_city', models.BooleanField(default=False, verbose_name='is major city')),
                ('is_hajj_city', models.BooleanField(default=False, verbose_name='is hajj city')),
                ('is_umrah_city', models.BooleanField(default=False, verbose_name='is umrah city')),
                ('is_active', models.BooleanField(default=True, verbose_name='is active')),
                ('latitude', models.DecimalField(blank=True, decimal_places=6, max_digits=9, null=True, verbose_name='latitude')),
                ('longitude', models.DecimalField(blank=True, decimal_places=6, max_digits=9, null=True, verbose_name='longitude')),
            ],
            options={
                'verbose_name': 'Saudi city',
                'verbose_name_plural': 'Saudi cities',
                'ordering': ['name_en'],
            },
        ),
        migrations.CreateModel(
            name='SaudiRegion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('region_code', models.CharField(choices=[('riyadh', 'Riyadh Province'), ('makkah', 'Makkah Province'), ('madinah', 'Madinah Province'), ('eastern', 'Eastern Province'), ('asir', 'Asir Province'), ('tabuk', 'Tabuk Province'), ('hail', 'Hail Province'), ('northern_borders', 'Northern Borders Province'), ('jizan', 'Jizan Province'), ('najran', 'Najran Province'), ('al_bahah', 'Al Bahah Province'), ('al_jouf', 'Al Jouf Province'), ('qassim', 'Qassim Province')], max_length=20, unique=True)),
                ('name_ar', models.CharField(max_length=100, verbose_name='name (Arabic)')),
                ('name_en', models.CharField(max_length=100, verbose_name='name (English)')),
                ('capital_ar', models.CharField(max_length=100, verbose_name='capital (Arabic)')),
                ('capital_en', models.CharField(max_length=100, verbose_name='capital (English)')),
                ('is_active', models.BooleanField(default=True, verbose_name='is active')),
            ],
            options={
                'verbose_name': 'Saudi region',
                'verbose_name_plural': 'Saudi regions',
                'ordering': ['name_en'],
            },
        ),
        migrations.CreateModel(
            name='UmrahPackage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('package_code', models.CharField(max_length=50, unique=True, verbose_name='package code')),
                ('name', models.CharField(max_length=255, verbose_name='package name')),
                ('name_ar', models.CharField(max_length=255, verbose_name='package name (Arabic)')),
                ('package_type', models.CharField(choices=[('economy', 'Economy'), ('standard', 'Standard'), ('deluxe', 'Deluxe'), ('premium', 'Premium'), ('luxury', 'Luxury')], default='standard', max_length=20, verbose_name='package type')),
                ('duration_days', models.IntegerField(default=15, verbose_name='duration (days)')),
                ('validity_from', models.DateField(verbose_name='validity from')),
                ('validity_to', models.DateField(verbose_name='validity to')),
                ('makkah_hotel', models.CharField(max_length=255, verbose_name='makkah hotel')),
                ('makkah_nights', models.IntegerField(default=7, verbose_name='makkah nights')),
                ('madinah_hotel', models.CharField(blank=True, max_length=255, verbose_name='madinah hotel')),
                ('madinah_nights', models.IntegerField(default=0, verbose_name='madinah nights')),
                ('flight_included', models.BooleanField(default=True, verbose_name='flight included')),
                ('visa_included', models.BooleanField(default=True, verbose_name='visa included')),
                ('transport_included', models.BooleanField(default=True, verbose_name='transport included')),
                ('ziyarat_included', models.BooleanField(default=True, verbose_name='ziyarat included')),
                ('base_price', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='base price')),
                ('commission_rate', models.DecimalField(decimal_places=2, default=Decimal('12.00'), max_digits=5, verbose_name='commission rate')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'umrah package',
                'verbose_name_plural': 'umrah packages',
                'ordering': ['package_type', 'base_price'],
            },
        ),
        migrations.CreateModel(
            name='User',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('first_name', models.CharField(blank=True, max_length=150, verbose_name='first name')),
                ('last_name', models.CharField(blank=True, max_length=150, verbose_name='last name')),
                ('is_staff', models.BooleanField(default=False, help_text='Designates whether the user can log into this admin site.', verbose_name='staff status')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this user should be treated as active. Unselect this instead of deleting accounts.', verbose_name='active')),
                ('date_joined', models.DateTimeField(default=django.utils.timezone.now, verbose_name='date joined')),
                ('email', models.EmailField(max_length=254, unique=True, verbose_name='email address')),
                ('username', models.CharField(blank=True, max_length=150, verbose_name='username')),
                ('phone', models.CharField(help_text='Saudi format: +9665XXXXXXXX', max_length=15, unique=True, validators=[django.core.validators.RegexValidator(message="Phone number must be in format: '+9665XXXXXXXX'", regex='^\\+9665\\d{8}$')], verbose_name='phone number')),
                ('user_type', models.CharField(choices=[('admin', 'Administrator'), ('super_agent', 'Super Agent'), ('agent', 'Travel Agent'), ('sub_agent', 'Sub Agent'), ('supplier', 'Service Supplier'), ('corporate', 'Corporate Client'), ('pilgrim', 'Pilgrim Service Provider')], default='agent', max_length=20, verbose_name='user type')),
                ('status', models.CharField(choices=[('active', 'Active'), ('inactive', 'Inactive'), ('suspended', 'Suspended'), ('pending', 'Pending'), ('blocked', 'Blocked'), ('under_review', 'Under Review')], default='pending', max_length=20, verbose_name='status')),
                ('company_name_ar', models.CharField(blank=True, max_length=255, verbose_name='company name (Arabic)')),
                ('company_name_en', models.CharField(blank=True, max_length=255, verbose_name='company name (English)')),
                ('company_registration', models.CharField(blank=True, max_length=50, null=True, unique=True, verbose_name='CR Number')),
                ('vat_number', models.CharField(blank=True, max_length=15, verbose_name='VAT Number')),
                ('credit_limit', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='credit limit')),
                ('current_balance', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='current balance')),
                ('wallet_balance', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='wallet balance')),
                ('commission_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5, verbose_name='commission rate')),
                ('referral_code', models.CharField(blank=True, max_length=20, null=True, unique=True, verbose_name='referral code')),
                ('scta_license', models.CharField(blank=True, max_length=50, verbose_name='SCTA License')),
                ('hajj_license', models.CharField(blank=True, max_length=50, verbose_name='Hajj License')),
                ('iata_number', models.CharField(blank=True, max_length=20, verbose_name='IATA Number')),
                ('email_verified', models.BooleanField(default=False, verbose_name='email verified')),
                ('phone_verified', models.BooleanField(default=False, verbose_name='phone verified')),
                ('kyc_verified', models.BooleanField(default=False, verbose_name='KYC verified')),
                ('kyc_submitted', models.DateTimeField(blank=True, null=True, verbose_name='KYC submitted')),
                ('address_ar', models.TextField(blank=True, verbose_name='address (Arabic)')),
                ('address_en', models.TextField(blank=True, verbose_name='address (English)')),
                ('last_login_ip', models.GenericIPAddressField(blank=True, null=True, verbose_name='last login IP')),
                ('last_activity', models.DateTimeField(blank=True, null=True, verbose_name='last activity')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),
                ('referred_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='referrals', to=settings.AUTH_USER_MODEL)),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),
                ('city', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='users', to='accounts.saudicity')),
            ],
            options={
                'verbose_name': 'user',
                'verbose_name_plural': 'users',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ComplianceCheck',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('check_type', models.CharField(choices=[('kyc', 'KYC Check'), ('aml', 'AML Check'), ('sanction', 'Sanction Check'), ('pep', 'PEP Check'), ('background', 'Background Check')], max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('passed', 'Passed'), ('failed', 'Failed'), ('flagged', 'Flagged')], default='pending', max_length=20)),
                ('score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('details', models.JSONField(blank=True, default=dict)),
                ('performed_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('performed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='performed_checks', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='compliance_checks', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'compliance check',
                'verbose_name_plural': 'compliance checks',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='FlightBooking',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('booking_id', models.CharField(max_length=50, unique=True, verbose_name='booking ID')),
                ('passenger_name', models.CharField(max_length=255, verbose_name='passenger name')),
                ('passenger_name_ar', models.CharField(blank=True, max_length=255, verbose_name='passenger name (Arabic)')),
                ('passenger_email', models.EmailField(blank=True, max_length=254, verbose_name='passenger email')),
                ('passenger_phone', models.CharField(blank=True, max_length=20, verbose_name='passenger phone')),
                ('flight_number', models.CharField(max_length=20, verbose_name='flight number')),
                ('departure_city', models.CharField(max_length=100, verbose_name='departure city')),
                ('arrival_city', models.CharField(max_length=100, verbose_name='arrival city')),
                ('departure_airport', models.CharField(max_length=10, verbose_name='departure airport')),
                ('arrival_airport', models.CharField(max_length=10, verbose_name='arrival airport')),
                ('departure_date', models.DateTimeField(verbose_name='departure date')),
                ('arrival_date', models.DateTimeField(verbose_name='arrival date')),
                ('travel_type', models.CharField(choices=[('domestic', 'Domestic'), ('international', 'International'), ('hajj', 'Hajj'), ('umrah', 'Umrah')], default='domestic', max_length=20, verbose_name='travel type')),
                ('booking_class', models.CharField(max_length=10, verbose_name='booking class')),
                ('base_fare', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='base fare')),
                ('tax', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='tax')),
                ('vat', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='VAT')),
                ('total_amount', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='total amount')),
                ('commission_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='commission amount')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('confirmed', 'Confirmed'), ('ticketed', 'Ticketed'), ('cancelled', 'Cancelled'), ('refunded', 'Refunded'), ('void', 'Void')], default='pending', max_length=20, verbose_name='status')),
                ('pnr', models.CharField(blank=True, max_length=10, verbose_name='PNR')),
                ('ticket_number', models.CharField(blank=True, max_length=20, verbose_name='ticket number')),
                ('booking_notes', models.TextField(blank=True, verbose_name='booking notes')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('agent', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='flight_bookings', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'flight booking',
                'verbose_name_plural': 'flight bookings',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='HotelBooking',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('booking_id', models.CharField(max_length=50, unique=True, verbose_name='booking ID')),
                ('guest_name', models.CharField(max_length=255, verbose_name='guest name')),
                ('guest_email', models.EmailField(blank=True, max_length=254, verbose_name='guest email')),
                ('guest_phone', models.CharField(blank=True, max_length=20, verbose_name='guest phone')),
                ('check_in', models.DateField(verbose_name='check in')),
                ('check_out', models.DateField(verbose_name='check out')),
                ('nights', models.IntegerField(default=1, verbose_name='nights')),
                ('rooms', models.IntegerField(default=1, verbose_name='number of rooms')),
                ('adults', models.IntegerField(default=1, verbose_name='adults')),
                ('children', models.IntegerField(default=0, verbose_name='children')),
                ('room_rate', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='room rate')),
                ('total_amount', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='total amount')),
                ('commission_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='commission amount')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('confirmed', 'Confirmed'), ('ticketed', 'Ticketed'), ('cancelled', 'Cancelled'), ('refunded', 'Refunded'), ('void', 'Void')], default='pending', max_length=20, verbose_name='status')),
                ('confirmation_number', models.CharField(blank=True, max_length=50, verbose_name='confirmation number')),
                ('booking_notes', models.TextField(blank=True, verbose_name='booking notes')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('agent', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='hotel_bookings', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'hotel booking',
                'verbose_name_plural': 'hotel bookings',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CommissionTransaction',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('transaction_id', models.CharField(max_length=50, unique=True, verbose_name='transaction ID')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='amount')),
                ('commission_rate', models.DecimalField(decimal_places=2, max_digits=5, verbose_name='commission rate')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('earned', 'Earned'), ('paid', 'Paid'), ('cancelled', 'Cancelled'), ('forfeited', 'Forfeited')], default='pending', max_length=20, verbose_name='status')),
                ('payment_date', models.DateField(blank=True, null=True, verbose_name='payment date')),
                ('remarks', models.TextField(blank=True, verbose_name='remarks')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('agent', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='commission_transactions', to=settings.AUTH_USER_MODEL)),
                ('booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='commissions', to='accounts.flightbooking')),
                ('hajj_booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='commissions', to='accounts.hajjpackage')),
                ('hotel_booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='commissions', to='accounts.hotelbooking')),
            ],
            options={
                'verbose_name': 'commission transaction',
                'verbose_name_plural': 'commission transactions',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Notification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('notification_type', models.CharField(choices=[('info', 'Information'), ('success', 'Success'), ('warning', 'Warning'), ('error', 'Error'), ('booking', 'Booking'), ('hajj', 'Hajj'), ('umrah', 'Umrah'), ('payment', 'Payment')], default='info', max_length=20)),
                ('title', models.CharField(max_length=255)),
                ('title_ar', models.CharField(blank=True, max_length=255, verbose_name='title (Arabic)')),
                ('message', models.TextField()),
                ('message_ar', models.TextField(blank=True, verbose_name='message (Arabic)')),
                ('is_read', models.BooleanField(default=False)),
                ('action_url', models.URLField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notifications', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'notification',
                'verbose_name_plural': 'notifications',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Payment',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('payment_id', models.CharField(max_length=50, unique=True, verbose_name='payment ID')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='amount')),
                ('vat_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12, verbose_name='VAT amount')),
                ('total_amount', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='total amount')),
                ('payment_method', models.CharField(choices=[('mada', 'Mada'), ('visa', 'Visa'), ('mastercard', 'MasterCard'), ('apple_pay', 'Apple Pay'), ('stc_pay', 'STC Pay'), ('bank_transfer', 'Bank Transfer'), ('wallet', 'Wallet'), ('cash', 'Cash'), ('cheque', 'Cheque')], max_length=50, verbose_name='payment method')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('success', 'Success'), ('failed', 'Failed'), ('cancelled', 'Cancelled'), ('refunded', 'Refunded'), ('partial_refund', 'Partially Refunded')], default='pending', max_length=20, verbose_name='status')),
                ('reference_number', models.CharField(blank=True, max_length=100, verbose_name='reference number')),
                ('transaction_id', models.CharField(blank=True, max_length=100, verbose_name='transaction ID')),
                ('bank_name', models.CharField(blank=True, max_length=100, verbose_name='bank name')),
                ('cheque_number', models.CharField(blank=True, max_length=50, verbose_name='cheque number')),
                ('description', models.TextField(blank=True, verbose_name='description')),
                ('description_ar', models.TextField(blank=True, verbose_name='description (Arabic)')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payments', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'payment',
                'verbose_name_plural': 'payments',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Refund',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('refund_id', models.CharField(max_length=50, unique=True, verbose_name='refund ID')),
                ('refund_amount', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='refund amount')),
                ('refund_method', models.CharField(choices=[('wallet', 'Wallet Credit'), ('bank_transfer', 'Bank Transfer'), ('original_payment', 'Original Payment Method'), ('cheque', 'Cheque')], max_length=30, verbose_name='refund method')),
                ('status', models.CharField(choices=[('requested', 'Requested'), ('approved', 'Approved'), ('processed', 'Processed'), ('rejected', 'Rejected'), ('cancelled', 'Cancelled')], default='requested', max_length=20, verbose_name='status')),
                ('reason', models.TextField(verbose_name='reason')),
                ('admin_notes', models.TextField(blank=True, verbose_name='admin notes')),
                ('requested_at', models.DateTimeField(auto_now_add=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('processed_at', models.DateTimeField(blank=True, null=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_refunds', to=settings.AUTH_USER_MODEL)),
                ('flight_booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='refunds', to='accounts.flightbooking')),
                ('hotel_booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='refunds', to='accounts.hotelbooking')),
                ('original_payment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='refunds', to='accounts.payment')),
                ('processed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='processed_refunds', to=settings.AUTH_USER_MODEL)),
                ('requested_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='requested_refunds', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='refunds', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'refund',
                'verbose_name_plural': 'refunds',
                'ordering': ['-requested_at'],
            },
        ),
        migrations.AddField(
            model_name='saudicity',
            name='region',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='cities', to='accounts.saudiregion'),
        ),
        migrations.CreateModel(
            name='ServiceSupplier',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=255, verbose_name='supplier name')),
                ('name_ar', models.CharField(blank=True, max_length=255, verbose_name='supplier name (Arabic)')),
                ('supplier_type', models.CharField(choices=[('airline', 'Airline'), ('hotel', 'Hotel'), ('transport', 'Transport'), ('insurance', 'Insurance'), ('visa', 'Visa Service'), ('hajj', 'Hajj Service'), ('umrah', 'Umrah Service'), ('guide', 'Tour Guide'), ('other', 'Other')], max_length=50, verbose_name='supplier type')),
                ('code', models.CharField(max_length=20, unique=True, verbose_name='supplier code')),
                ('commission_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5, verbose_name='commission rate')),
                ('contact_person', models.CharField(blank=True, max_length=255, verbose_name='contact person')),
                ('contact_email', models.EmailField(blank=True, max_length=254, verbose_name='contact email')),
                ('contact_phone', models.CharField(blank=True, max_length=20, verbose_name='contact phone')),
                ('is_active', models.BooleanField(default=True, verbose_name='is active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'service supplier',
                'verbose_name_plural': 'service suppliers',
                'ordering': ['name'],
                'indexes': [models.Index(fields=['supplier_type', 'is_active'], name='accounts_se_supplie_c188af_idx'), models.Index(fields=['code'], name='accounts_se_code_0f005d_idx')],
            },
        ),
        migrations.AddField(
            model_name='hotelbooking',
            name='hotel',
            field=models.ForeignKey(limit_choices_to={'supplier_type': 'hotel'}, on_delete=django.db.models.deletion.PROTECT, related_name='hotel_bookings', to='accounts.servicesupplier'),
        ),
        migrations.AddField(
            model_name='flightbooking',
            name='airline',
            field=models.ForeignKey(limit_choices_to={'supplier_type': 'airline'}, on_delete=django.db.models.deletion.PROTECT, related_name='flights', to='accounts.servicesupplier'),
        ),
        migrations.CreateModel(
            name='SMSCode',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('phone', models.CharField(max_length=15)),
                ('code', models.CharField(max_length=6)),
                ('purpose', models.CharField(choices=[('login', 'Login'), ('registration', 'Registration'), ('phone_verification', 'Phone Verification'), ('password_reset', 'Password Reset'), ('transaction', 'Transaction'), ('kyc', 'KYC Verification')], max_length=30)),
                ('is_used', models.BooleanField(default=False)),
                ('expires_at', models.DateTimeField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'SMS code',
                'verbose_name_plural': 'SMS codes',
                'indexes': [models.Index(fields=['phone', 'purpose', 'is_used'], name='accounts_sm_phone_4eccbe_idx'), models.Index(fields=['expires_at'], name='accounts_sm_expires_05aae3_idx')],
            },
        ),
        migrations.CreateModel(
            name='Transaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('transaction_id', models.CharField(max_length=50, unique=True)),
                ('transaction_type', models.CharField(choices=[('deposit', 'Deposit'), ('withdrawal', 'Withdrawal'), ('booking', 'Booking'), ('hajj', 'Hajj Booking'), ('umrah', 'Umrah Booking'), ('refund', 'Refund'), ('commission', 'Commission'), ('adjustment', 'Adjustment')], max_length=20)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=12)),
                ('currency', models.CharField(default='SAR', max_length=3)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('description', models.TextField(blank=True)),
                ('description_ar', models.TextField(blank=True, verbose_name='description (Arabic)')),
                ('reference', models.CharField(blank=True, max_length=100)),
                ('balance_before', models.DecimalField(decimal_places=2, max_digits=12)),
                ('balance_after', models.DecimalField(decimal_places=2, max_digits=12)),
                ('vat_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12, verbose_name='VAT Amount')),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='transactions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'transaction',
                'verbose_name_plural': 'transactions',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Invoice',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('invoice_number', models.CharField(max_length=50, unique=True, verbose_name='invoice number')),
                ('subtotal', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='subtotal')),
                ('vat_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12, verbose_name='VAT amount')),
                ('total_amount', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='total amount')),
                ('paid_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12, verbose_name='paid amount')),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('issued', 'Issued'), ('paid', 'Paid'), ('overdue', 'Overdue'), ('cancelled', 'Cancelled'), ('partial_paid', 'Partially Paid')], default='draft', max_length=20, verbose_name='status')),
                ('issue_date', models.DateField(default=django.utils.timezone.now, verbose_name='issue date')),
                ('due_date', models.DateField(verbose_name='due date')),
                ('payment_date', models.DateField(blank=True, null=True, verbose_name='payment date')),
                ('notes', models.TextField(blank=True, verbose_name='notes')),
                ('notes_ar', models.TextField(blank=True, verbose_name='notes (Arabic)')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('flight_booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='invoices', to='accounts.flightbooking')),
                ('hajj_package', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='invoices', to='accounts.hajjpackage')),
                ('hotel_booking', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='invoices', to='accounts.hotelbooking')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='invoices', to=settings.AUTH_USER_MODEL)),
                ('umrah_package', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='invoices', to='accounts.umrahpackage')),
            ],
            options={
                'verbose_name': 'invoice',
                'verbose_name_plural': 'invoices',
                'ordering': ['-issue_date'],
            },
        ),
        migrations.CreateModel(
            name='UserActivityLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('activity_type', models.CharField(choices=[('login', 'Login'), ('logout', 'Logout'), ('registration', 'Registration'), ('profile_update', 'Profile Update'), ('booking', 'Booking'), ('payment', 'Payment'), ('kyc', 'KYC Submission'), ('document', 'Document Upload')], max_length=50)),
                ('description', models.TextField()),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='activity_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'user activity log',
                'verbose_name_plural': 'user activity logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='UserProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('business_type', models.CharField(blank=True, max_length=50, verbose_name='business type')),
                ('years_in_business', models.IntegerField(default=0, verbose_name='years in business')),
                ('bank_name_ar', models.CharField(blank=True, max_length=100, verbose_name='bank name (Arabic)')),
                ('bank_name_en', models.CharField(blank=True, max_length=100, verbose_name='bank name (English)')),
                ('account_number', models.CharField(blank=True, max_length=50, verbose_name='account number')),
                ('iban', models.CharField(blank=True, max_length=24, verbose_name='IBAN')),
                ('total_bookings', models.IntegerField(default=0, verbose_name='total bookings')),
                ('total_sales', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='total sales')),
                ('total_commission', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='total commission')),
                ('hajj_bookings', models.IntegerField(default=0, verbose_name='hajj bookings')),
                ('umrah_bookings', models.IntegerField(default=0, verbose_name='umrah bookings')),
                ('language', models.CharField(choices=[('en', 'English'), ('ar', 'Arabic')], default='en', max_length=10, verbose_name='language')),
                ('timezone', models.CharField(default='Asia/Riyadh', max_length=50, verbose_name='timezone')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='profile', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'user profile',
                'verbose_name_plural': 'user profiles',
            },
        ),
        migrations.CreateModel(
            name='AgentHierarchy',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('hierarchy_level', models.IntegerField(default=1, verbose_name='Hierarchy Level')),
                ('commission_share', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Percentage of commission shared with parent agent', max_digits=5, verbose_name='Commission Share')),
                ('is_active', models.BooleanField(default=True, verbose_name='is active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('child_agent', models.OneToOneField(limit_choices_to={'user_type__in': ['agent', 'sub_agent']}, on_delete=django.db.models.deletion.CASCADE, related_name='parent_hierarchy', to=settings.AUTH_USER_MODEL)),
                ('parent_agent', models.ForeignKey(limit_choices_to={'user_type__in': ['super_agent', 'agent']}, on_delete=django.db.models.deletion.CASCADE, related_name='children_agents', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'agent hierarchy',
                'verbose_name_plural': 'agent hierarchies',
                'indexes': [models.Index(fields=['parent_agent', 'is_active'], name='accounts_ag_parent__934cfd_idx'), models.Index(fields=['child_agent'], name='accounts_ag_child_a_a076e2_idx')],
                'unique_together': {('parent_agent', 'child_agent')},
            },
        ),
        migrations.CreateModel(
            name='CreditRequest',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('current_limit', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Current Credit Limit')),
                ('requested_limit', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='Requested Credit Limit')),
                ('purpose', models.TextField(blank=True, verbose_name='Purpose')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('under_review', 'Under Review'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('review_notes', models.TextField(blank=True, verbose_name='Review Notes')),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('reviewed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reviewed_credit_requests', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='credit_requests', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'credit request',
                'verbose_name_plural': 'credit requests',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'status'], name='accounts_cr_user_id_9dd78f_idx'), models.Index(fields=['status', 'created_at'], name='accounts_cr_status_282a05_idx')],
            },
        ),
        migrations.CreateModel(
            name='Document',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('document_type', models.CharField(choices=[('passport', 'Passport'), ('saudi_id', 'Saudi National ID'), ('iqama', 'Iqama'), ('driving_license', 'Driving License'), ('trade_license', 'Trade License'), ('vat_certificate', 'VAT Certificate'), ('commercial_registration', 'Commercial Registration'), ('scta_license', 'SCTA License'), ('hajj_license', 'Hajj License'), ('bank_statement', 'Bank Statement'), ('other', 'Other')], max_length=50)),
                ('document_number', models.CharField(max_length=100)),
                ('document_file', models.FileField(upload_to='documents/%Y/%m/%d/')),
                ('front_image', models.ImageField(blank=True, null=True, upload_to='documents/front/%Y/%m/%d/')),
                ('back_image', models.ImageField(blank=True, null=True, upload_to='documents/back/%Y/%m/%d/')),
                ('issue_date', models.DateField(blank=True, null=True)),
                ('expiry_date', models.DateField(blank=True, null=True)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('verified', 'Verified'), ('rejected', 'Rejected'), ('expired', 'Expired')], default='pending', max_length=20)),
                ('verification_notes', models.TextField(blank=True)),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to=settings.AUTH_USER_MODEL)),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='verified_documents', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'document',
                'verbose_name_plural': 'documents',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'document_type'], name='accounts_do_user_id_9d2026_idx'), models.Index(fields=['status', 'expiry_date'], name='accounts_do_status_558121_idx')],
            },
        ),
        migrations.CreateModel(
            name='IPWhitelist',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('ip_address', models.GenericIPAddressField()),
                ('description', models.CharField(blank=True, max_length=255)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='whitelisted_ips', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'IP whitelist',
                'verbose_name_plural': 'IP whitelists',
                'unique_together': {('user', 'ip_address')},
            },
        ),
        migrations.CreateModel(
            name='LoginHistory',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('ip_address', models.GenericIPAddressField()),
                ('user_agent', models.TextField(blank=True)),
                ('location', models.CharField(blank=True, max_length=255)),
                ('country_code', models.CharField(blank=True, default='SA', max_length=2)),
                ('success', models.BooleanField(default=True)),
                ('failure_reason', models.CharField(blank=True, max_length=255)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='login_history', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'login history',
                'verbose_name_plural': 'login histories',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'created_at'], name='accounts_lo_user_id_a5a726_idx'), models.Index(fields=['ip_address'], name='accounts_lo_ip_addr_142937_idx'), models.Index(fields=['success'], name='accounts_lo_success_746caa_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='payment',
            index=models.Index(fields=['payment_id'], name='accounts_pa_payment_374fdc_idx'),
        ),
        migrations.AddIndex(
            model_name='payment',
            index=models.Index(fields=['user', 'status'], name='accounts_pa_user_id_618f05_idx'),
        ),
        migrations.AddIndex(
            model_name='payment',
            index=models.Index(fields=['payment_method'], name='accounts_pa_payment_4005cd_idx'),
        ),
        migrations.AddIndex(
            model_name='user',
            index=models.Index(fields=['email'], name='accounts_us_email_74c8d6_idx'),
        ),
        migrations.AddIndex(
            model_name='user',
            index=models.Index(fields=['phone'], name='accounts_us_phone_f54457_idx'),
        ),
        migrations.AddIndex(
            model_name='user',
            index=models.Index(fields=['user_type', 'status'], name='accounts_us_user_ty_e34060_idx'),
        ),
        migrations.AddIndex(
            model_name='user',
            index=models.Index(fields=['referral_code'], name='accounts_us_referra_2cbfb5_idx'),
        ),
        migrations.AddIndex(
            model_name='user',
            index=models.Index(fields=['company_registration'], name='accounts_us_company_77da21_idx'),
        ),
        migrations.AddIndex(
            model_name='hotelbooking',
            index=models.Index(fields=['booking_id'], name='accounts_ho_booking_585225_idx'),
        ),
        migrations.AddIndex(
            model_name='hotelbooking',
            index=models.Index(fields=['agent', 'status'], name='accounts_ho_agent_i_43618d_idx'),
        ),
        migrations.AddIndex(
            model_name='hotelbooking',
            index=models.Index(fields=['check_in'], name='accounts_ho_check_i_bb3f7b_idx'),
        ),
        migrations.AddIndex(
            model_name='flightbooking',
            index=models.Index(fields=['booking_id'], name='accounts_fl_booking_11494e_idx'),
        ),
        migrations.AddIndex(
            model_name='flightbooking',
            index=models.Index(fields=['agent', 'status'], name='accounts_fl_agent_i_679b15_idx'),
        ),
        migrations.AddIndex(
            model_name='flightbooking',
            index=models.Index(fields=['departure_date'], name='accounts_fl_departu_dc58b3_idx'),
        ),
        migrations.AddIndex(
            model_name='flightbooking',
            index=models.Index(fields=['pnr'], name='accounts_fl_pnr_f35e79_idx'),
        ),
        migrations.AddIndex(
            model_name='invoice',
            index=models.Index(fields=['invoice_number'], name='accounts_in_invoice_72c085_idx'),
        ),
        migrations.AddIndex(
            model_name='invoice',
            index=models.Index(fields=['user', 'status'], name='accounts_in_user_id_4ddeea_idx'),
        ),
        migrations.AddIndex(
            model_name='invoice',
            index=models.Index(fields=['due_date'], name='accounts_in_due_dat_309676_idx'),
        ),
    ]
